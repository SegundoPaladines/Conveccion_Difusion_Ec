clear;
clc;
delta_x=1/25;
delta_t=1/350;

D=1/10;
V=0.5;

%%t inicial t=0.05
x0_i=[  0.183161
 0.039229
 0.003609
 0.000119
 -0.000011
 -0.000011
 -0.000009
 -0.000008
 -0.000007
 -0.000006
 -0.000005
 -0.000005
 -0.000004
 -0.000004
 -0.000003
 -0.000003
 -0.000003
 -0.000002
 -0.000002
 -0.000002
 -0.000002
 -0.000002
 -0.000001
 -0.000001
 -0.000001
 -0.000001
 -0.000001
 -0.000000
 -0.000000
 -0.000000
 0.000000
 0.000000
 0.000000
 0.000001
 0.000001
 0.000001
 0.000001
 0.000001
 0.000002
 0.000002
 0.000002
 0.000002
 0.000002
 0.000003
 0.000003
 0.000003
 0.000004
 0.000004
 0.000005
 0.000005
 0.000006
 0.000007
 0.000008
 0.000009
 0.000011
 0.000011
 -0.000119
 -0.003609
 -0.039229
 -0.183161];
 
 
%%x inicial x=0.05;
 t0_j=[0.183161
 0.213755
 0.227415
 0.235426
 0.240768
 0.244609
 0.247512
 0.249786
 0.251616
 0.253118
 0.254372
 0.255433
 0.256341
 0.257126
 0.257810
 0.258410
 0.258939
 0.259409
 0.259829
 0.260204
 0.260542
 0.260847
 0.261123
 0.261374
 0.261603
 0.261811
 0.262002
 0.262177
 0.262338
 0.262486
 0.262622
 0.262748
 0.262865
 0.262973
 0.263073
 0.263166
 0.263252
 0.263333
 0.263408
 0.263478
 0.263543
 0.263604
 0.263661
 0.263715
 0.263765
 0.263812
 0.263856
 0.263897
 0.263936
 0.263972
 0.264007
 0.264039
 0.264069
 0.264098
 0.264125
 0.264150
 0.264175
 0.264197
 0.264219
 0.264239];
 
 %%x final x=5.95;
 tf_j=[-0.183161
 -0.213755
 -0.227415
 -0.235426
 -0.240768
 -0.244609
 -0.247512
 -0.249786
 -0.251616
 -0.253118
 -0.254372
 -0.255433
 -0.256341
 -0.257126
 -0.257810
 -0.258410
 -0.258939
 -0.259409
 -0.259829
 -0.260204
 -0.260542
 -0.260847
 -0.261123
 -0.261374
 -0.261603
 -0.261811
 -0.262002
 -0.262177
 -0.262338
 -0.262486
 -0.262622
 -0.262748
 -0.262865
 -0.262973
 -0.263073
 -0.263166
 -0.263252
 -0.263333
 -0.263408
 -0.263478
 -0.263543
 -0.263604
 -0.263661
 -0.263715
 -0.263765
 -0.263812
 -0.263856
 -0.263897
 -0.263936
 -0.263972
 -0.264007
 -0.264039
 -0.264069
 -0.264098
 -0.264125
 -0.264150
 -0.264175
 -0.264197
 -0.264219
 -0.264239];
 
 c=0;
 for i=1:length(x0_i)
   
   c(1,i)=x0_i(i);
   c(i,1)=t0_j(i);
   c(i,length(x0_i))=tf_j(i);
   
 endfor
 %fin for
 for j=1:length(t0_j)-1
   for i=2:length(x0_i)-1
      c(j+1,i)=c(j,i)+(((D*delta_t)/(delta_x^2))*(c(j,i+1)-2*c(j,i)+c(j,i-1)))-(((V*delta_t)/(delta_x))*(c(j,i+1)-c(j,i)));
   endfor
 endfor
 %fin for
 
  [x,t]=meshgrid(0.05:0.1:6,0.05:0.05:3);
  subplot(1,2,2);
  surf(x,t,c);
  title("Grafica Diferencias finitas");
  ylabel("t","fontweight","bold","fontsize",20);
  xlabel("x","fontweight","bold","fontsize",20);
  zlabel("c(x,t)","fontweight","bold","fontsize",20);
  colormap hot; 
  
  
  fprintf('\n fin programa');